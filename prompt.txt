# Prompt untuk AI/Copilot: PHP Native Action-Based Framework

## ğŸ“‹ Overview Arsitektur

Anda sedang bekerja dengan PHP native framework yang menggunakan:
- **Routing otomatis**: URL dengan underscore â†’ file dengan slash (`users_user-management` â†’ `pages/users/user-management.php`)
- **Action-based pattern**: Setiap view punya mirror action handler di `actions/pages/`
- **Security-first**: Semua query menggunakan prepared statements, semua input di-sanitasi
- **UUID primary keys**: Tidak ada auto-increment integer, semua ID adalah UUID v4
- **Session + localStorage hybrid auth**: Session untuk security, localStorage untuk convenience
- **Modular auto-login**: Auto-login menggunakan API endpoint terpisah (loginauto.php)
- **Variable-based routing**: Menggunakan variable $content untuk include pages

---

## ğŸ—‚ï¸ Struktur Folder (Wajib Dipahami)

```
Root/
â”œâ”€â”€ actions/                    # Mirror dari pages/ untuk handlers
â”‚   â”œâ”€â”€ index.php              # Router action (sama seperti index.php)
â”‚   â”œâ”€â”€ login.php              # Handler login POST
â”‚   â”œâ”€â”€ register.php           # Handler register POST
â”‚   â”œâ”€â”€ logout.php             # Handler logout GET
â”‚   â””â”€â”€ pages/                 # Mirror exact dari pages/
â”‚       â””â”€â”€ users/
â”‚           â””â”€â”€ user-management.php  # Handler CRUD users
â”‚
â”œâ”€â”€ pages/                     # View files (konten halaman)
â”‚   â”œâ”€â”€ dashboard.php
â”‚   â””â”€â”€ users/
â”‚       â””â”€â”€ user-management.php      # View CRUD users
â”‚
â”œâ”€â”€ functions/                 # Helper functions (WAJIB DIGUNAKAN)
â”‚   â”œâ”€â”€ sanitasi.php          # sani() - Input sanitization
â”‚   â”œâ”€â”€ secure_query.php      # querySecure(), executeSecure()
â”‚   â”œâ”€â”€ generate_uuid.php     # generate_uuid()
â”‚   â”œâ”€â”€ pagination.php        # makePagination(), showPagination()
â”‚   â”œâ”€â”€ upload_file.php       # uploadFile() dengan kompresi
â”‚   â”œâ”€â”€ auto-routing.php      # Variable-based routing system
â”‚   â”œâ”€â”€ auto-cek-login-html.php   # Auto-login check untuk HTML pages
â”‚   â””â”€â”€ auto-cek-login-action.php # Auto-login check untuk action files
â”‚
â”œâ”€â”€ assets/                    # Static files
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â””â”€â”€ images/               # Upload destination
â”‚
â”œâ”€â”€ config.php                # Database connection ($con)
â”œâ”€â”€ index.php                 # Entry point + router utama
â”œâ”€â”€ sidebar.php               # Navigation menu
â”œâ”€â”€ login.php                 # Login view
â”œâ”€â”€ register.php              # Register view
â””â”€â”€ generate.php              # CLI untuk generate files
```

---

## ğŸ”„ Routing System (CRITICAL)

### URL ke File Conversion

**Rule utama:**
1. Underscore (`_`) di URL â†’ Slash (`/`) di path file
2. Dash (`-`) di URL â†’ Spasi di page title
3. Default page: `dashboard`
4. Routing menggunakan **variable $content** bukan function

**Contoh:**
```
URL: index.php?hal=users_user-management
â†’ File: pages/users/user-management.php
â†’ Title: User Management

URL: index.php?hal=admin_settings_config
â†’ File: pages/admin/settings/config.php
â†’ Title: Config
```

### Auto-Routing Implementation (auto-routing.php)

```php
<?php
$hal = 'dashboard';
$textTitle = 'Dashboard';
if (isset($_GET['hal'])) {
    $getHal = sani($_GET['hal']);
    $hal = str_replace('_', '/', $getHal);
    $lastUnderscore = strrpos($getHal, '_');
    $titlePart = ($lastUnderscore !== false) ? substr($getHal, $lastUnderscore + 1) : $getHal;
    $textTitle = ucwords(str_replace('-', ' ', $titlePart));
}
$content = 'pages/' . $hal . '.php';
?>
```

**Variable penting:**
- `$hal` = path file tanpa pages/ dan .php
- `$textTitle` = title halaman
- `$content` = full path ke file page untuk di-include

### Struktur Mirror (View â†” Action)

**WAJIB mengikuti pattern ini:**
```
View:   pages/users/user-management.php
Action: actions/pages/users/user-management.php
```

**Form action HARUS ke actions dengan parameter hal:**
```html
<form action="actions/?hal=users_user-management" method="POST">
```

**Delete link juga ke actions:**
```html
<a href="actions/?hal=users_user-management&deleteUser=<?= $id ?>">
```

---

## ğŸ” Security Patterns (MANDATORY)

### 1. Input Sanitization

**SELALU gunakan sani() untuk SEMUA input:**
```php
// âœ… CORRECT
$name = sani($_POST['name']);
$email = sani($_GET['email']);
$search = sani($_REQUEST['search']);

// âŒ WRONG - NEVER do this
$name = $_POST['name'];
```

**sani() handle array otomatis:**
```php
$data = sani($_POST); // Semua value di array akan di-sanitize
```

### 2. Database Queries (WAJIB Prepared Statements)

**NEVER gunakan query langsung:**
```php
// âŒ WRONG - Vulnerable to SQL injection
$query = "SELECT * FROM users WHERE id = '$id'";
mysqli_query($con, $query);
```

**ALWAYS gunakan querySecure() untuk SELECT:**
```php
// âœ… CORRECT
$result = querySecure($con, 
    "SELECT * FROM users WHERE id = ?", 
    [$id], 
    's'  // s = string
);
$user = mysqli_fetch_assoc($result);
```

**ALWAYS gunakan executeSecure() untuk INSERT/UPDATE/DELETE:**
```php
// âœ… CORRECT - INSERT
$result = executeSecure($con,
    "INSERT INTO users (id, name, email) VALUES (?, ?, ?)",
    [$id, $name, $email],
    'sss'  // s s s = string string string
);

// âœ… CORRECT - UPDATE
$result = executeSecure($con,
    "UPDATE users SET name = ?, email = ? WHERE id = ?",
    [$name, $email, $id],
    'sss'
);

// âœ… CORRECT - DELETE
$result = executeSecure($con,
    "DELETE FROM users WHERE id = ?",
    [$id],
    's'
);
```

**Type codes untuk bind_param:**
- `s` = string
- `i` = integer
- `d` = double/float
- `b` = blob

### 3. Password Handling

**ALWAYS hash password sebelum save:**
```php
// âœ… CORRECT - Saat register/add user
$password = password_hash(sani($_POST['password']), PASSWORD_DEFAULT);

// âœ… CORRECT - Saat login verify
$result = querySecure($con, "SELECT * FROM users WHERE email = ?", [$email], 's');
$user = mysqli_fetch_assoc($result);

if ($user && password_verify($inputPassword, $user['password'])) {
    // Login success
}

// âœ… CORRECT - Saat update (optional)
$password_new = sani($_POST['password']);
$password = !empty($password_new) 
    ? password_hash($password_new, PASSWORD_DEFAULT) 
    : $password_old;  // Keep old if empty
```

### 4. Auto-Login System (Modular Approach)

**Framework menggunakan 3 file terpisah untuk auto-login:**

**1. functions/auto-cek-login-html.php** - Untuk halaman HTML (index.php):
```php
// Cek session, jika tidak login:
// 1. Tampilkan loading screen
// 2. JavaScript cek localStorage
// 3. Jika ada credentials â†’ hit loginauto.php API
// 4. Jika berhasil â†’ reload page
// 5. Jika gagal â†’ redirect ke login.php
```

**2. functions/auto-cek-login-action.php** - Untuk action handlers (actions/index.php):
```php
// Cek session, jika tidak login:
// 1. Cek POST auto_login parameter
// 2. Verify credentials
// 3. Set session atau exit
```

**3. actions/loginauto.php** - API endpoint untuk auto-login:
```php
// Accept POST JSON request
// Return JSON response:
// { success: true/false, message: string, clear_storage: bool }
```

**Integration di index.php:**
```php
include 'functions/auto-cek-login-html.php'; // After routing
```

**Integration di actions/index.php:**
```php
include '../functions/auto-cek-login-action.php'; // After includes
```

**Security features:**
- API menggunakan JSON POST (bukan form)
- Password tetap di-verify dengan password_verify()
- Auto-clear localStorage jika credentials salah
- Session flag untuk clear localStorage

### 5. UUID Primary Keys

**ALWAYS gunakan UUID untuk primary key:**
```php
// âœ… CORRECT
$id = generate_uuid();
$result = executeSecure($con,
    "INSERT INTO users (id, name) VALUES (?, ?)",
    [$id, $name],
    'ss'
);

// âŒ WRONG - Never use auto-increment ID exposure
```

**Database schema HARUS:**
```sql
CREATE TABLE users (
    id VARCHAR(36) NOT NULL PRIMARY KEY,  -- UUID v4
    -- other fields
);
```

---

## ğŸ“ CRUD Pattern (Template Wajib)

### View File Template

**Location:** `pages/module/feature.php`

```php
<?php
// Get search parameter
$search = isset($_GET['search']) ? sani($_GET['search']) : '';
$page = isset($_GET['page']) ? (int)$_GET['page'] : 1;

// Build query dengan prepared statement
$whereClause = '';
$params = [];
$types = '';

if (!empty($search)) {
    $searchParam = '%' . $search . '%';
    $whereClause = "WHERE name LIKE ? OR email LIKE ?";
    $params = [$searchParam, $searchParam];
    $types = 'ss';
}

$query = "SELECT * FROM users $whereClause ORDER BY created_at DESC";
$pagination = makePagination($con, $query, $params, $types, $page, 10);
?>

<!-- Alert messages -->
<?php if (isset($_SESSION['message'])): ?>
    <div class="alert alert-<?= $_SESSION['message_type'] == 'success' ? 'success' : 'danger' ?> alert-dismissible fade show">
        <?= $_SESSION['message'] ?>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
    <?php unset($_SESSION['message'], $_SESSION['message_type']); ?>
<?php endif; ?>

<!-- Button add new -->
<button data-bs-toggle="modal" data-bs-target="#addModal">Add New</button>

<!-- Search form -->
<form method="get">
    <input type="hidden" name="hal" value="module_feature">
    <input type="text" name="search" value="<?= $search ?>">
    <button type="submit">Search</button>
</form>

<!-- Data table -->
<table>
    <?php while ($row = mysqli_fetch_assoc($pagination['data'])): ?>
        <tr>
            <td><?= $row['name'] ?></td>
            <td>
                <button onclick="editData('<?= $row['id'] ?>')">Edit</button>
                <a href="actions/?hal=module_feature&delete=<?= $row['id'] ?>" 
                   onclick="return confirm('Sure?')">Delete</a>
            </td>
        </tr>
    <?php endwhile; ?>
</table>

<!-- Pagination -->
<?php if ($pagination['total_pages'] > 1): ?>
    <?php showPagination($pagination['current_page'], $pagination['total_pages'], 
        ['hal' => 'module_feature', 'search' => $search]); ?>
<?php endif; ?>

<!-- Modal Add -->
<div class="modal" id="addModal">
    <form action="actions/?hal=module_feature" method="POST" enctype="multipart/form-data">
        <input type="text" name="name" required>
        <input type="email" name="email" required>
        <input type="file" name="photo">
        <button type="submit" name="addData">Save</button>
    </form>
</div>

<!-- Modal Edit -->
<div class="modal" id="editModal">
    <form action="actions/?hal=module_feature" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="id" id="edit_id">
        <input type="hidden" name="photo_old" id="edit_photo_old">
        <input type="text" name="name" id="edit_name" required>
        <input type="email" name="email" id="edit_email" required>
        <input type="file" name="photo">
        <button type="submit" name="updateData">Update</button>
    </form>
</div>

<script>
function editData(id) {
    // Fetch data via AJAX or set from PHP
    // Populate modal fields
    const modal = new bootstrap.Modal(document.getElementById('editModal'));
    modal.show();
}
</script>
```

### Action File Template

**Location:** `actions/pages/module/feature.php`

**CRITICAL: Calculate relative path based on folder depth:**
- `actions/pages/users/` â†’ root = `../../../` (3 levels)
- `actions/pages/admin/settings/` â†’ root = `../../../../` (4 levels)

```php
<?php
/**
 * Action: module/feature
 * Relative path depth: 3 (actions/ â†’ pages/ â†’ module/)
 */

session_start();

// Calculate relative path (count folder depth)
$depth = 3; // actions/ (1) â†’ pages/ (2) â†’ module/ (3)
$rootPath = str_repeat('../', $depth);

include $rootPath . 'functions/sanitasi.php';
include $rootPath . 'functions/secure_query.php';
include $rootPath . 'functions/generate_uuid.php';
include $rootPath . 'config.php';

// POST Handlers
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    
    // ========== CREATE ==========
    if (isset($_POST['addData'])) {
        include $rootPath . 'functions/upload_file.php';
        
        $id = generate_uuid();
        $name = sani($_POST['name']);
        $email = sani($_POST['email']);
        
        // Handle file upload
        $photo = null;
        if (isset($_FILES['photo']) && $_FILES['photo']['error'] === UPLOAD_ERR_OK) {
            $result = uploadFile($_FILES['photo'], $rootPath . 'assets/images/photos/', 2 * 1024 * 1024);
            if ($result['success']) {
                $photo = str_replace($rootPath, '', $result['file_path']);
            }
        }
        
        // Insert with prepared statement
        $insertResult = executeSecure($con,
            "INSERT INTO table_name (id, name, email, photo) VALUES (?, ?, ?, ?)",
            [$id, $name, $email, $photo],
            'ssss'
        );
        
        if ($insertResult) {
            $_SESSION['message'] = 'Data successfully added!';
            $_SESSION['message_type'] = 'success';
        } else {
            $_SESSION['message'] = 'Failed to add data!';
            $_SESSION['message_type'] = 'error';
        }
        
        header('Location: ' . $rootPath . 'index.php?hal=module_feature');
        exit;
    }
    
    // ========== UPDATE ==========
    if (isset($_POST['updateData'])) {
        include $rootPath . 'functions/upload_file.php';
        
        $id = sani($_POST['id']);
        $name = sani($_POST['name']);
        $email = sani($_POST['email']);
        $photo_old = sani($_POST['photo_old']);
        
        // Default: keep old photo
        $photo = $photo_old;
        
        // Handle new upload
        if (isset($_FILES['photo']) && 
            $_FILES['photo']['error'] === UPLOAD_ERR_OK && 
            !empty($_FILES['photo']['name'])) {
            
            $result = uploadFile($_FILES['photo'], $rootPath . 'assets/images/photos/', 2 * 1024 * 1024);
            
            if ($result['success']) {
                // Delete old file
                if (!empty($photo_old) && file_exists($rootPath . $photo_old)) {
                    unlink($rootPath . $photo_old);
                }
                $photo = str_replace($rootPath, '', $result['file_path']);
            }
        }
        
        // Update with prepared statement
        $updateResult = executeSecure($con,
            "UPDATE table_name SET name = ?, email = ?, photo = ? WHERE id = ?",
            [$name, $email, $photo, $id],
            'ssss'
        );
        
        if ($updateResult) {
            $_SESSION['message'] = 'Data successfully updated!';
            $_SESSION['message_type'] = 'success';
        } else {
            $_SESSION['message'] = 'Failed to update data!';
            $_SESSION['message_type'] = 'error';
        }
        
        header('Location: ' . $rootPath . 'index.php?hal=module_feature');
        exit;
    }
    
} 
// ========== DELETE (GET) ==========
elseif (isset($_GET['delete'])) {
    $id = sani($_GET['delete']);
    
    // Get current data for file deletion
    $resultData = querySecure($con, "SELECT photo FROM table_name WHERE id = ?", [$id], 's');
    $data = mysqli_fetch_assoc($resultData);
    
    // Delete record
    $deleteResult = executeSecure($con, "DELETE FROM table_name WHERE id = ?", [$id], 's');
    
    if ($deleteResult) {
        // Delete associated file
        if (!empty($data['photo']) && file_exists($rootPath . $data['photo'])) {
            unlink($rootPath . $data['photo']);
        }
        
        $_SESSION['message'] = 'Data successfully deleted!';
        $_SESSION['message_type'] = 'success';
    } else {
        $_SESSION['message'] = 'Failed to delete data!';
        $_SESSION['message_type'] = 'error';
    }
    
    header('Location: ' . $rootPath . 'index.php?hal=module_feature');
    exit;
}
// ========== Invalid Request ==========
else {
    header('Location: ' . $rootPath . 'index.php');
    exit;
}
?>
```

---

## ğŸ“¤ File Upload Pattern

**ALWAYS gunakan uploadFile() function:**
```php
include '../../../functions/upload_file.php';

// Check if file uploaded
if (isset($_FILES['photo']) && $_FILES['photo']['error'] === UPLOAD_ERR_OK) {
    $result = uploadFile(
        $_FILES['photo'], 
        '../../../assets/images/photos/',  // Target dir with trailing slash
        2 * 1024 * 1024,                    // Max 2MB
        ['jpg', 'jpeg', 'png']              // Optional: allowed types
    );
    
    if ($result['success']) {
        $photo = str_replace('../../../', '', $result['file_path']);
        // Save $photo to database
    } else {
        $_SESSION['message'] = $result['message'];
        $_SESSION['message_type'] = 'error';
    }
}
```

**Update pattern (dengan delete old file):**
```php
// Get current file from database
$resultData = querySecure($con, "SELECT photo FROM table WHERE id = ?", [$id], 's');
$currentData = mysqli_fetch_assoc($resultData);
$photo = $currentData['photo']; // Default: keep old

// Check for new upload
if (isset($_FILES['photo']) && 
    $_FILES['photo']['error'] === UPLOAD_ERR_OK && 
    !empty($_FILES['photo']['name'])) {
    
    $result = uploadFile($_FILES['photo'], '../../../assets/images/photos/', 2 * 1024 * 1024);
    
    if ($result['success']) {
        // Delete old file
        if (!empty($photo) && file_exists('../../../' . $photo)) {
            unlink('../../../' . $photo);
        }
        $photo = str_replace('../../../', '', $result['file_path']);
    }
}

// Continue with UPDATE query...
```

---

## ğŸ”„ Pagination Pattern

**ALWAYS gunakan makePagination():**
```php
// Get parameters
$search = isset($_GET['search']) ? sani($_GET['search']) : '';
$page = isset($_GET['page']) ? (int)$_GET['page'] : 1;

// Build WHERE clause
$whereClause = '';
$params = [];
$types = '';

if (!empty($search)) {
    $searchParam = '%' . $search . '%';
    $whereClause = "WHERE name LIKE ? OR email LIKE ?";
    $params = [$searchParam, $searchParam];
    $types = 'ss';
}

// Build query
$query = "SELECT * FROM users $whereClause ORDER BY created_at DESC";

// Get paginated data
$pagination = makePagination($con, $query, $params, $types, $page, 10);

// Display data
while ($row = mysqli_fetch_assoc($pagination['data'])) {
    // Display row
}

// Display pagination links
if ($pagination['total_pages'] > 1) {
    showPagination(
        $pagination['current_page'], 
        $pagination['total_pages'],
        ['hal' => 'module_feature', 'search' => $search]  // Preserve query params
    );
}
```

---

## ğŸ”§ Generator Usage

**ALWAYS gunakan generate.php untuk buat module baru:**
```bash
php generate.php module_feature
```

**Output:**
- `pages/module/feature.php` â†’ View template
- `actions/pages/module/feature.php` â†’ Action handler template
- Relative path otomatis calculated

**Setelah generate:**
1. Edit view file â†’ tambah form, table, modal
2. Edit action file â†’ implement CRUD logic
3. Add menu ke `sidebar.php`

---

## ğŸ“‹ Checklist Saat Develop Feature Baru

### âœ… Planning
- [ ] Determine module name & feature name
- [ ] Run generator: `php generate.php module_feature`
- [ ] Create database table dengan UUID primary key
- [ ] Add menu item di `sidebar.php`

### âœ… View File (pages/)
- [ ] Add search form dengan parameter `hal`
- [ ] Implement makePagination() dengan prepared statement
- [ ] Create modal add dengan action ke `actions/?hal=...`
- [ ] Create modal edit dengan action ke `actions/?hal=...`
- [ ] Add delete link ke `actions/?hal=...&delete=id`
- [ ] Display alert message dari session
- [ ] Use showPagination() untuk pagination links

### âœ… Action File (actions/pages/)
- [ ] Calculate correct relative path depth
- [ ] Include all required functions (sanitasi, secure_query, upload_file, etc)
- [ ] Implement CREATE dengan generate_uuid()
- [ ] Implement UPDATE dengan file handling (keep old if no new)
- [ ] Implement DELETE dengan file cleanup
- [ ] ALWAYS use executeSecure() / querySecure()
- [ ] ALWAYS sanitize all input dengan sani()
- [ ] Set session message untuk feedback
- [ ] Redirect ke index.php dengan parameter hal

### âœ… Security Check
- [ ] All inputs di-sanitize dengan sani()
- [ ] All queries menggunakan prepared statements
- [ ] Password di-hash dengan password_hash()
- [ ] File upload menggunakan uploadFile()
- [ ] UUID untuk primary key
- [ ] No direct mysqli_query() usage
- [ ] No SQL string concatenation

### âœ… Testing
- [ ] Test add data (dengan & tanpa file upload)
- [ ] Test update data (dengan & tanpa file upload)
- [ ] Test delete data (file terhapus?)
- [ ] Test search functionality
- [ ] Test pagination (multiple pages)
- [ ] Test SQL injection (input dengan quotes)
- [ ] Test file upload validation (size, type)
- [ ] Test session message display

---

## âš ï¸ Common Mistakes (AVOID)

### âŒ Path Errors
```php
// âŒ WRONG - Hardcoded path depth
include '../../config.php';  // Might be wrong depth

// âœ… CORRECT - Calculate based on actual folder structure
// For actions/pages/users/file.php â†’ root is ../../../
include '../../../config.php';
```

### âŒ Direct Query
```php
// âŒ WRONG - SQL injection vulnerable
$id = $_GET['id'];
$query = "SELECT * FROM users WHERE id = '$id'";
$result = mysqli_query($con, $query);

// âœ… CORRECT - Prepared statement
$id = sani($_GET['id']);
$result = querySecure($con, "SELECT * FROM users WHERE id = ?", [$id], 's');
```

### âŒ No Sanitization
```php
// âŒ WRONG - XSS vulnerable
$name = $_POST['name'];

// âœ… CORRECT
$name = sani($_POST['name']);
```

### âŒ File Upload Bug
```php
// âŒ WRONG - Will cause "undefined" if no new upload
$photo = $_FILES['photo'];

// âœ… CORRECT - Keep old if no new upload
$photo = $photo_old; // Default
if (isset($_FILES['photo']) && $_FILES['photo']['error'] === UPLOAD_ERR_OK) {
    // Upload new file
}
```

### âŒ Password Handling
```php
// âŒ WRONG - Plain text password
$password = $_POST['password'];

// âœ… CORRECT - Hash password
$password = password_hash(sani($_POST['password']), PASSWORD_DEFAULT);
```

### âŒ Auto-increment ID
```php
// âŒ WRONG - Sequential ID exposure
$query = "INSERT INTO users (name) VALUES (?)"; // id auto-increment

// âœ… CORRECT - UUID
$id = generate_uuid();
$query = "INSERT INTO users (id, name) VALUES (?, ?)";
```

---

## ğŸ¯ Code Style Guide

### Naming Conventions
- **Variables:** `$snake_case`
- **Functions:** `camelCase()`
- **Constants:** `UPPER_CASE`
- **Files:** `kebab-case.php`
- **Folders:** `lowercase`

### PHP Code Style
```php
// Include statements at top
include 'config.php';

// Session operations
session_start();

// Constants
define('MAX_SIZE', 2097152);

// Variables
$user_name = sani($_POST['name']);
$user_email = sani($_POST['email']);

// Control structures (space before parenthesis)
if ($condition) {
    // Code
}

// Functions
function generateUuid()
{
    // Code
}
```

---

## ğŸ“š Function Reference Quick Guide

### sani($data)
- Sanitize input (string or array)
- Always use for $_POST, $_GET, $_REQUEST

### querySecure($con, $query, $params, $types)
- For SELECT queries
- Returns mysqli_result

### executeSecure($con, $query, $params, $types)
- For INSERT/UPDATE/DELETE
- Returns boolean or last insert id

### generate_uuid()
- Returns UUID v4 string (36 chars)
- Use for all primary keys

### uploadFile($file, $targetDir, $maxSize, $allowedTypes)
- Upload dengan auto-compression
- Returns array with success/message/file_path

### makePagination($con, $query, $params, $types, $page, $limit)
- Database pagination dengan prepared statement
- Returns array with data, total_pages, etc

### showPagination($currentPage, $totalPages, $queryParams, $maxLinks)
- Display Bootstrap pagination UI
- Preserve query parameters

---

## ğŸš€ Development Workflow

1. **Plan Feature**
   - Define module & feature name
   - Design database table

2. **Generate Files**
   ```bash
   php generate.php module_feature
   ```

3. **Setup Database**
   ```sql
   CREATE TABLE table_name (
       id VARCHAR(36) PRIMARY KEY,
       -- fields
   );
   ```

4. **Add Menu**
   - Edit `sidebar.php`
   - Add menu item dengan parameter hal

5. **Develop View**
   - Edit `pages/module/feature.php`
   - Add search, table, modals

6. **Develop Action**
   - Edit `actions/pages/module/feature.php`
   - Implement CRUD dengan security patterns

7. **Test & Debug**
   - Test all CRUD operations
   - Check security (sanitization, prepared statements)
   - Test file upload & deletion

8. **Deploy**
   - Review checklist
   - Test in production environment

---

## ğŸ”’ Security Reminder

**NEVER SKIP:**
1. âœ… sani() untuk semua input
2. âœ… Prepared statements untuk semua query
3. âœ… password_hash() untuk password
4. âœ… UUID untuk primary key
5. âœ… uploadFile() untuk file upload
6. âœ… File validation (size, type)
7. âœ… Error logging (jangan expose ke user)
8. âœ… Session message untuk feedback

**FRAMEWORK SUDAH PROVIDE:**
- Input sanitization function
- Prepared statement wrappers
- UUID generator
- File upload dengan validation
- Password hashing examples
- Pagination dengan security

**YOUR JOB:**
- ALWAYS gunakan function yang ada
- NEVER bypass security measures
- ALWAYS validate input
- ALWAYS handle errors gracefully

---

## ğŸ’¡ Tips untuk AI/Copilot

1. **Saat diminta buat CRUD:**
   - Generate files dengan `generate.php` dulu
   - Follow template pattern yang ada
   - Jangan lupa relative path calculation

2. **Saat diminta fix bug:**
   - Check relative path depth
   - Verify sanitization usage
   - Check prepared statement types

3. **Saat diminta add feature:**
   - Maintain consistency dengan existing code
   - Use helper functions yang sudah ada
   - Follow security patterns

4. **Saat diminta optimize:**
   - Check query efficiency (indexes)
   - Verify pagination implementation
   - Check file upload compression

5. **Saat diminta refactor:**
   - Maintain backward compatibility
   - Keep security measures
   - Update documentation

---

**Framework ini dirancang untuk security & maintainability. SELALU ikuti patterns yang sudah ada!**
